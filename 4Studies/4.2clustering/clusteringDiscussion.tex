\subsection{Discussion of cluster categories}
When tool designers are considering what features to include, data about usage in practice is valuable.  Behavioral similarity clustering  helps to discern these behaviors by looking beyond the structural details of specific patterns and seeing trends in  matching behavior. Many clusters are defined by the presence of particular tokens, such as the colon for the cluster in Table~\ref{table:exampleCluster}.

\subsubsection{Implications}

\paragraph{Supporting source code parsing}  One of the six common cluster categories, \emph{Code Search and Variable Capturing}, has a very specific purpose of parsing source code files. This shows a very specific use of regular expressions in practice, occurring in 13\% of all projects containing some clustered regex.  Further study is needed into how users employ regular expressions to parse source code.

\paragraph{Possible bracket parsing bugs} The \emph{Content of Brackets and Parenthesis} cluster revolves around parsing balanced delimiters, like parenthesis, quotation marks and angle brackets.  Regexes belonging to this category occur in 15\% of all projects containing some clustered regex.  In some cases, parsing balanced delimiters using regexes is known to cause problems for programmers\footurl{http://stackoverflow.com/questions/1732348}, because (most) regular expressions cannot fully describe balanced delimiter rules.  More study is needed into how angle bracket parsing using regex effects source code.

\paragraph{Anchors have a strong behavioral effect}  Anchors were the only features that had enough of an effect on behavior that clusters formed based on their presence.  Other regexes did not cluster around features, but more instead clustered around characters and character classes.  This implies that certain behaviors can only be specified using anchors.  Of the four regex analysis tools listed in Table~\ref{table:featuresInTools}, only two support the END anchor.  This implies that tool designers should work to better support anchors.

\paragraph{Finding specific content using delimiters}  Two categorical clusters, \emph{Specific Characters Must Match} and \emph{Two or More Characters in Sequence}, deal with identifying the presence of specific character(s).  While multiple character matching subsumes single character matching, the overarching theme is that these regexes are looking to validate strings based on the presence of very specific content, as would be done for many common activities listed in Table~\ref{table:regextasks}, such as, ``Locating content within a file or files."  More study is needed into what content is most frequently searched for, but this cluster analysis indicates that version numbers, twitter or user handles, hex values, decimal numbers, capitalized words, and particular combinations of whitespace, slashes and other delimiters were discernible targets.

\subsubsection{Threats to validity}
The following threats impact these results and conclusions:

\paragraph{Measures}  The similarity measure between regexes used in the cluster algorithm is computed empirically rather than analytically, and the more Rex-generated strings used to compute the similarity measure, the more likely it is to be accurate. Our experiments used 400 strings to balance performance and precision, but a higher number could lead to more cohesive clusters. Additionally, regex patters that use any feature not supported by Rex were omitted from the cluster analysis. Last, the threshold of 0.75 was chosen based on the MCL recommendation, but it may not create optimal clusters.

\paragraph{Instrumentation} Regular expression patterns were clustered using strings generated by the Rex tool. We assume that the strings generated by Rex are reasonably diverse to help characterize the regex behavior. To mitigate this threat, Rex generated 400 strings per regex and we inspected strings randomly to ensure diversity.

